<!DOCTYPE HTML>
<html>
<meta charset="utf-8">
<head>
<title> testing pixi</title>
<script src="https://cdn.socket.io/socket.io-1.1.0.js"></script>
<script src="pixi.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script src="rules.js"></script>

</head>
<body>

<p id="status"> WAiting for other players</p>
<p id="p1"> </p>
<p id="p1Hand"</p>
<p id="p2"> </p>
<p id="p3Hand"</p>
<p id="p3"> </p>
<p id="p4Hand"</p>
<p id="p4"> </p>
<p id="p4Hand"</p>

<script>

var socket= io.connect('http://localhost:3000/');
var full=false;
var PlayerHand;
var username;
var roomid;
var currturn;

// Display users that join the server
function updateStatus(users){
         
		var count =1;

        for(var i=0;i<users.length;i++){		
        	if(users[i]!=null){
        		//console.log(i);
        		var pid ="p"+(i+1);
        		document.getElementById(pid).innerHTML="Player "+ users[i].username +" has connected";


        	}
        }

        
		
	//	document.getElementById("p2").innerHTML="Player "+users[1].username +" has connected";
		if(users.length==4){

			document.getElementById("status").innerHTML="Game Starting";	


			//socket.emit('startgame',full);
			//document.getElementById("p1").innerHTML="Player "+users[0].username +" has connected";
			//document.getElementById("p2").innerHTML="Player "+users[1].username +" has connected";
			//document.getElementById("p3").innerHTML="Player "+users[2].username +" has connected";
			//document.getElementById("p4").innerHTML="Player "+users[3].username +" has connected";
			



			full=true;
		}
		}




// Poll for users joining the game
 // Intial user list
 socket.on('playerlist',function(users){
		//console.log(users);
		console.log(users);
		updateStatus(users);
	});


	

socket.on('updateList',function (users){
	//console.log(users);
	console.log("i got everything");
	var identifier = document.cookie.split(';');
	 username = identifier[0].split('=')[1];
	 roomid = identifier[1].split('=')[1];
     //console.log(roomid);
     //console.log(username);
     //console.log(users);
	 if (roomid!=users[0].roomid){
	 	return;
	 	console.log('different room ');
	 }
	 else{updateStatus(users); console.log('same room');}



	
	
	

});

// once game is full, get hands from server


socket.on('startgame',function(newgame){
	console.log("Got here");
	//console.log(newgame);
   // console.log(newgame.Hand);
    PlayerHand=newgame.Hand;  
    //compare(PlayerHand[0],PlayerHand[1]);
   // console.log(PlayerHand);
   PlayerHand=sortie(PlayerHand);
   console.log(PlayerHand);
   var cear = new Combo(PlayerHand);
    console.log(cear);
    if(newgame.turn==true){
    	console.log("My turn");



    }
	





});




    function sortie(A){
              var tits =[];
             //console.log(A);
        var val=A[0];
        var index=0;
 	if(A.length==2){
            if(A[0].value <A[1].value){return A;}
            else{ var t = A[0]; A[0]=A[1]; A[1]=t; return A;}
            
            
            
        }

 	else{
            
            
            
            
            for(var i =1; i<=A.length-1;i++){
                if(A[i].value <val.value){
                    val=A[i];
                    index=i;
                
                
            }  else if(A[i].value==val.value){
                
                    if(A[i].rank<val.rank){
                        val=A[i];
                        index=i;
                    }
                
                
                
                
                
            }
        }    
            var tmp = A[0];
            A[0]=val;
            A[index]=tmp;     
            
           
            tits.push(val);
            
            return tits.concat(sortie(A.slice(1,A.length)));
            
            
 				










 		
                





 	}
 	


 	
                   
                }


</script>

</body>
</html>
