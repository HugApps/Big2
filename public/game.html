<!DOCTYPE HTML>
<html>
<meta charset="utf-8">
<head>
<title> testing pixi</title>
<script src="https://cdn.socket.io/socket.io-1.1.0.js"></script>
<script src="pixi.min.js"></script>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>

</head>
<body>

<p id="status"> WAiting for other players</p>
<p id="p1"> </p>
<p id="p2"> </p>
<p id="p3"> </p>
<p id="p4"> </p>

<script>

var socket= io.connect('http://localhost:3000/');
var full=false;
var PlayerHand;
var username;
var roomid;

// Display users that join the server
function updateStatus(users){

		var count =1;
        for(var i=0;i<users.length;i++){
        	if(users[i]!=null){
        		//console.log(i);
        		var pid ="p"+(i+1);
        		document.getElementById(pid).innerHTML="Player "+ users[i].username +" has connected";


        	}
        }

        
		
	//	document.getElementById("p2").innerHTML="Player "+users[1].username +" has connected";
		if(users.length==2){

			document.getElementById("status").innerHTML="Game Starting";	


			socket.emit('startgame',full);
			//document.getElementById("p1").innerHTML="Player "+users[0].username +" has connected";
			//document.getElementById("p2").innerHTML="Player "+users[1].username +" has connected";
			//document.getElementById("p3").innerHTML="Player "+users[2].username +" has connected";
			//document.getElementById("p4").innerHTML="Player "+users[3].username +" has connected";
			



			full=true;
		}
		}




// Poll for users joining the game
 // Intial user list
 socket.on('playerlist',function(users){
		//console.log(users);
		updateStatus(users);
	});


	

socket.on('updateList',function (users){
	console.log("i got everything");
	var identifier = document.cookie.split(';');
	 username = identifier[0].split('=')[1];
	 roomid = identifier[1].split('=')[1];
     console.log(roomid);
     console.log(username);
	 if (roomid!=users[0].roomid){
	 	return;
	 	console.log('different room ');
	 }
	 else{updateStatus(users); console.log('same room');}



	
	
	

});

// once game is full, get hands from server


socket.on('startgame',function(newgame){
	console.log("Got here");
	for (var i = 0 ; i <newgame.length;i++){
		console.log(newgame[i].username);
		if(newgame[i].username==username){
			console.log(newgame[i].username);
			console.log("Got hand");
			PlayerHand=newgame[i].Hand;
			console.log(PlayerHand);

		}



	}






})



</script>

</body>
</html>
